# App å±è”½åŠŸèƒ½è¨­è¨ˆæ–‡æª”

**åŠŸèƒ½ä»£è™Ÿ**: Forbidden Apps (Focus Shield)
**ç‰ˆæœ¬**: v1.2.0
**ç‹€æ…‹**: ğŸ“‹ è¦åŠƒä¸­
**æ—¥æœŸ**: 2025-10-22

---

## ğŸ›¡ï¸ æ ¸å¿ƒè¨­è¨ˆåŸå‰‡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                            â”‚
â”‚  âš ï¸  é€™æ˜¯ä¸€å€‹å®Œå…¨å¯é¸çš„é™„åŠ åŠŸèƒ½                              â”‚
â”‚                                                            â”‚
â”‚  âœ… ä¸ä¿®æ”¹ä»»ä½•ç¾æœ‰ä»£ç¢¼é‚è¼¯                                   â”‚
â”‚  âœ… åªåœ¨ç¾æœ‰æ–¹æ³•æœ«å°¾ã€Œæ·»åŠ ã€Shield èª¿ç”¨                      â”‚
â”‚  âœ… é»˜èªé—œé–‰ï¼Œç”¨æˆ¶éœ€ä¸»å‹•å•Ÿç”¨                                â”‚
â”‚  âœ… åŠŸèƒ½æœªå•Ÿç”¨æ™‚ï¼Œèª¿ç”¨ç«‹å³è¿”å›ï¼ˆé›¶é–‹éŠ·ï¼‰                     â”‚
â”‚  âœ… å³ä½¿å‡ºéŒ¯ï¼Œä¹Ÿä¸å½±éŸ¿è¨ˆæ™‚å™¨æœ¬èº«                             â”‚
â”‚  âœ… å‘ä¸‹å…¼å®¹ iOS 14ï¼ˆåŠŸèƒ½ä¸é¡¯ç¤ºï¼‰                           â”‚
â”‚                                                            â”‚
â”‚  åŸæœ‰åŠŸèƒ½ï¼ˆè¨ˆæ™‚å™¨ã€çµ±è¨ˆã€é€šçŸ¥ã€Dynamic Islandï¼‰            â”‚
â”‚  ä¿æŒ 100% ä¸è®Š                                            â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## åŠŸèƒ½æ¦‚è¿°

**åƒ…åœ¨å°ˆæ³¨æ™‚é–“ï¼ˆFocusï¼‰æœŸé–“**å±è”½ç”¨æˆ¶é¸æ“‡çš„ appï¼Œé˜²æ­¢åˆ†å¿ƒã€‚ç•¶ç”¨æˆ¶å˜—è©¦æ‰“é–‹è¢«å±è”½çš„ app æ™‚ï¼Œç³»çµ±æœƒé¡¯ç¤ºå±è”½ç•«é¢ã€‚**ä¼‘æ¯æ™‚é–“ï¼ˆBreakï¼‰è‡ªå‹•è§£é™¤å±è”½**ï¼Œè®“ç”¨æˆ¶è‡ªç”±ä½¿ç”¨æ‰€æœ‰ app æ”¾é¬†ã€‚

### âš ï¸ é‡è¦è¨­è¨ˆåŸå‰‡

**é€™æ˜¯ä¸€å€‹å®Œå…¨å¯é¸çš„é™„åŠ åŠŸèƒ½ï¼Œä¸æœƒå½±éŸ¿ä»»ä½•ç¾æœ‰åŠŸèƒ½ï¼š**

âœ… **é»˜èªé—œé–‰** - ç”¨æˆ¶éœ€è¦ä¸»å‹•å•Ÿç”¨
âœ… **å®Œå…¨ç¨ç«‹** - ä¸ä¿®æ”¹ç¾æœ‰çš„è¨ˆæ™‚å™¨ã€çµ±è¨ˆã€é€šçŸ¥ã€Dynamic Island ç­‰åŠŸèƒ½
âœ… **å¯éš¨æ™‚åœç”¨** - ç”¨æˆ¶å¯ä»¥éš¨æ™‚åœ¨è¨­ç½®ä¸­é—œé–‰
âœ… **å‘ä¸‹å…¼å®¹** - å°æ–¼ä¸æ”¯æ´ iOS 15.0+ çš„è¨­å‚™ï¼Œæ­¤åŠŸèƒ½ä¸é¡¯ç¤º
âœ… **é›¶ä¾µå…¥** - å³ä½¿å•Ÿç”¨ï¼Œä¹Ÿåªæ˜¯åœ¨ç¾æœ‰æµç¨‹ä¸­ã€ŒåŠ å…¥ã€å±è”½é‚è¼¯ï¼Œä¸æ”¹è®ŠåŸæœ‰è¡Œç‚º

### æ ¸å¿ƒåƒ¹å€¼

- **å·¥ä½œæ™‚å°ˆæ³¨**ï¼šFocus æœŸé–“ç‰©ç†å±¤é¢é˜²æ­¢ç”¨æˆ¶æ‰“é–‹åˆ†æ•£æ³¨æ„åŠ›çš„ app
- **ä¼‘æ¯æ™‚æ”¾é¬†**ï¼šBreak æœŸé–“è‡ªå‹•è§£é™¤é™åˆ¶ï¼ŒçœŸæ­£æ”¾é¬†
- **è‡ªæˆ‘ç®¡ç†**ï¼šç”¨æˆ¶å¯è‡ªè¨‚å±è”½æ¸…å–®ï¼Œé©æ‡‰å€‹äººéœ€æ±‚
- **è¦–è¦ºæé†’**ï¼šå±è”½ç•«é¢å¯é¡¯ç¤ºå‰©é¤˜å°ˆæ³¨æ™‚é–“ï¼Œå¼·åŒ–æ™‚é–“æ„è­˜
- **ä¸å½±éŸ¿åŸåŠŸèƒ½**ï¼šæ‰€æœ‰ç¾æœ‰åŠŸèƒ½ï¼ˆè¨ˆæ™‚ã€çµ±è¨ˆã€é€šçŸ¥ç­‰ï¼‰ä¿æŒä¸è®Š

---

## æŠ€è¡“æ–¹æ¡ˆ

### iOS Framework é¸æ“‡

ä½¿ç”¨ Apple æä¾›çš„ **Family Controls** æ¡†æ¶ï¼ˆiOS 15.0+ï¼‰ï¼š

| Framework | ç”¨é€” |
|-----------|------|
| `FamilyControls` | è«‹æ±‚æˆæ¬Šã€é¸æ“‡è¦å±è”½çš„ app |
| `ManagedSettings` | æ‡‰ç”¨å±è”½è¨­ç½® |
| `DeviceActivity` | ç›£æ§ app ä½¿ç”¨ï¼ˆå¯é¸ï¼Œç”¨æ–¼é€²éšåŠŸèƒ½ï¼‰ |

### æ ¸å¿ƒ API

```swift
import FamilyControls
import ManagedSettings

// 1. è«‹æ±‚æˆæ¬Š
let center = AuthorizationCenter.shared
try await center.requestAuthorization(for: .individual)

// 2. è®“ç”¨æˆ¶é¸æ“‡è¦å±è”½çš„ app
@State private var selection = FamilyActivitySelection()

FamilyActivityPicker(selection: $selection)

// 3. æ‡‰ç”¨å±è”½è¨­ç½®
let store = ManagedSettingsStore()
store.shield.applications = selection.applicationTokens
```

---

## åŠŸèƒ½è¨­è¨ˆ

### 1. è¨­ç½®é é¢

**ä½ç½®**: Settings > Focus Shield

**UI å…ƒç´ **:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âš™ï¸ Settings                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                 â”‚
â”‚ ğŸ›¡ï¸ Focus Shield                 â”‚
â”‚   Block apps during focus       â”‚
â”‚                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Enable Focus Shield    [âœ“]  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Select Apps to Block        â”‚ â”‚
â”‚ â”‚ 5 apps selected        â†’    â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                 â”‚
â”‚ ğŸ’¡ How it works                 â”‚
â”‚ â€¢ Blocks selected apps during   â”‚
â”‚   Focus time only               â”‚
â”‚ â€¢ Automatically unlocks during  â”‚
â”‚   Break time                    â”‚
â”‚                                 â”‚
â”‚ ğŸ“Š Current Status               â”‚
â”‚ Shield is: Active ğŸ›¡ï¸            â”‚
â”‚ (or: Inactive / Not in Focus)   â”‚
â”‚                                 â”‚
â”‚ â„¹ï¸  Requires Screen Time        â”‚
â”‚    permission to work           â”‚
â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç‹€æ…‹æŒ‡ç¤ºå™¨èªªæ˜**:
- é¡¯ç¤ºç•¶å‰å±è”½æ˜¯å¦å•Ÿç”¨
- å¯¦æ™‚æ›´æ–°ï¼ˆç›£è½è¨ˆæ™‚å™¨ç‹€æ…‹è®ŠåŒ–ï¼‰
- å¹«åŠ©ç”¨æˆ¶ç¢ºèªåŠŸèƒ½æ­£åœ¨å·¥ä½œ

### 2. App é¸æ“‡ä»‹é¢

ä½¿ç”¨ç³»çµ±æä¾›çš„ `FamilyActivityPicker`ï¼š

- âœ… é¡¯ç¤ºæ‰€æœ‰å·²å®‰è£çš„ appï¼ˆå« icon å’Œåç¨±ï¼‰
- âœ… æ”¯æ´æœå°‹
- âœ… æ”¯æ´å¤šé¸
- âœ… åˆ†é¡é¡¯ç¤ºï¼ˆç¤¾äº¤ã€å¨›æ¨‚ã€éŠæˆ²ç­‰ï¼‰
- âœ… ç³»çµ±åŸç”Ÿè¨­è¨ˆï¼Œç”¨æˆ¶é«”é©—ä¸€è‡´

### 3. å±è”½ç•«é¢

ç•¶ç”¨æˆ¶å˜—è©¦æ‰“é–‹è¢«å±è”½çš„ app æ™‚ï¼ŒiOS æœƒé¡¯ç¤ºï¼š

**é è¨­ç•«é¢**ï¼ˆç„¡è‡ªè¨‚ï¼‰:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                 â”‚
â”‚          ğŸ”’                     â”‚
â”‚                                 â”‚
â”‚     App is Limited              â”‚
â”‚                                 â”‚
â”‚   This app is not available     â”‚
â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è‡ªè¨‚ç•«é¢**ï¼ˆiOS 16.0+ï¼Œä½¿ç”¨ `ShieldConfiguration`ï¼‰:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                 â”‚
â”‚          ğŸ…                     â”‚
â”‚                                 â”‚
â”‚    Stay Focused!                â”‚
â”‚                                 â”‚
â”‚   23:45 remaining               â”‚
â”‚                                 â”‚
â”‚  You chose to focus. Keep going!â”‚
â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4. æˆæ¬Šæµç¨‹

```
ç”¨æˆ¶é–‹å•Ÿ Focus Shield
    â†“
æª¢æŸ¥æ˜¯å¦å·²æˆæ¬Š
    â†“
å¦ â†’ é¡¯ç¤ºèªªæ˜å°è©±æ¡†
    â†“
è«‹æ±‚ Family Controls æˆæ¬Š
    â†“
æˆæ¬ŠæˆåŠŸ â†’ é¡¯ç¤º App é¸æ“‡å™¨
æˆæ¬Šå¤±æ•— â†’ é¡¯ç¤ºéŒ¯èª¤æç¤º
```

**èªªæ˜å°è©±æ¡†æ–‡æ¡ˆ**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ›¡ï¸ Enable Focus Shield          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                 â”‚
â”‚ TomatoClock needs Screen Time   â”‚
â”‚ permission to help you stay     â”‚
â”‚ focused.                        â”‚
â”‚                                 â”‚
â”‚ This allows the app to:         â”‚
â”‚ â€¢ Block distracting apps        â”‚
â”‚ â€¢ During your focus sessions    â”‚
â”‚                                 â”‚
â”‚ Your data stays private and     â”‚
â”‚ is never shared.                â”‚
â”‚                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚   Cancel    â”‚ â”‚  Continue   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å¯¦ç¾è¨ˆç•«

### Phase 1: åŸºç¤åŠŸèƒ½ (v1.2.0)

#### 1.1 æ·»åŠ  Capability
- [ ] åœ¨ Xcode ä¸­æ·»åŠ  "Family Controls" capability
- [ ] æ›´æ–° entitlements æ–‡ä»¶

#### 1.2 å‰µå»ºè¨­ç½® UI
- [ ] æ–°å¢ `FocusShieldSettingsView.swift`
- [ ] æ•´åˆåˆ°ä¸»è¨­ç½®é é¢
- [ ] å¯¦ç¾é–‹é—œæ§åˆ¶

#### 1.3 æˆæ¬Šç®¡ç†
- [ ] å‰µå»º `FocusShieldService.swift`
- [ ] å¯¦ç¾æˆæ¬Šè«‹æ±‚é‚è¼¯
- [ ] è™•ç†æˆæ¬Šç‹€æ…‹è®ŠåŒ–

#### 1.4 App é¸æ“‡
- [ ] æ•´åˆ `FamilyActivityPicker`
- [ ] å„²å­˜é¸æ“‡çš„ app tokens
- [ ] å¯¦ç¾é¸æ“‡æŒä¹…åŒ–ï¼ˆUserDefaults æˆ– Core Dataï¼‰

#### 1.5 å±è”½é‚è¼¯
- [ ] åœ¨ TimerEngine å„æ–¹æ³•æœ«å°¾æ·»åŠ  Shield èª¿ç”¨
  - [ ] `start()` - Focus æ¨¡å¼æ™‚å•Ÿç”¨
  - [ ] `pause()` - è§£é™¤å±è”½
  - [ ] `resume()` - Focus æ¨¡å¼æ™‚é‡æ–°å•Ÿç”¨
  - [ ] `handleCompletion()` - è§£é™¤å±è”½
  - [ ] `reset()` - è§£é™¤å±è”½
- [ ] å¯¦ç¾ app å•Ÿå‹•æ™‚çš„ç‹€æ…‹åŒæ­¥
  - [ ] åœ¨ AppDelegate/SceneDelegate æ·»åŠ  `syncShieldStateWithTimer()`
  - [ ] è®€å– TimerData ä¸¦æ ¹æ“šç•¶å‰ç‹€æ…‹æ±ºå®šå±è”½ç‹€æ…‹
  - [ ] è™•ç†ç‹€æ…‹éæœŸçš„æƒ…æ³

#### 1.6 æ¸¬è©¦

**åŠŸèƒ½æ¸¬è©¦**:
- [ ] æ¸¬è©¦æˆæ¬Šæµç¨‹
- [ ] æ¸¬è©¦ app å±è”½/è§£é™¤
- [ ] æ¸¬è©¦ç‹€æ…‹æŒä¹…åŒ–
- [ ] æ¸¬è©¦é‚Šç•Œæƒ…æ³ï¼ˆapp åœ¨èƒŒæ™¯æ™‚é–‹å§‹ Focusã€å¼·åˆ¶é—œé–‰ç­‰ï¼‰

**âš ï¸ å›æ­¸æ¸¬è©¦ï¼ˆç¢ºä¿ä¸å½±éŸ¿ç¾æœ‰åŠŸèƒ½ï¼‰**:
- [ ] **è¨ˆæ™‚å™¨åŸºç¤åŠŸèƒ½**ï¼šStart/Pause/Resume/Reset åœ¨æœªå•Ÿç”¨ Shield æ™‚è¡Œç‚ºå®Œå…¨ä¸è®Š
- [ ] **Focus/Break åˆ‡æ›**ï¼šè‡ªå‹•åˆ‡æ›é‚è¼¯ä¸å—å½±éŸ¿
- [ ] **çµ±è¨ˆæ•¸æ“š**ï¼šSession è¨ˆæ•¸ã€å®Œæˆæ¬¡æ•¸ç­‰æ•¸æ“šæ­£ç¢º
- [ ] **é€šçŸ¥**ï¼šå®Œæˆé€šçŸ¥æ­£å¸¸ç™¼é€
- [ ] **Dynamic Island**ï¼šLive Activity é¡¯ç¤ºä¸å—å½±éŸ¿
- [ ] **æŒä¹…åŒ–**ï¼šè¨ˆæ™‚å™¨ç‹€æ…‹ä¿å­˜/è®€å–ä¸å—å½±éŸ¿
- [ ] **iOS 14 è¨­å‚™**ï¼šåœ¨ä¸æ”¯æ´ Focus Shield çš„è¨­å‚™ä¸Šï¼Œapp æ­£å¸¸é‹è¡Œï¼ˆåŠŸèƒ½ä¸é¡¯ç¤ºï¼‰
- [ ] **æœªæˆæ¬Šæƒ…æ³**ï¼šå¦‚æœç”¨æˆ¶æ‹’çµ• Screen Time æˆæ¬Šï¼Œè¨ˆæ™‚å™¨åŠŸèƒ½å®Œå…¨æ­£å¸¸
- [ ] **éŒ¯èª¤æƒ…æ³**ï¼šå³ä½¿ Shield æœå‹™å´©æ½°ï¼Œè¨ˆæ™‚å™¨ç¹¼çºŒæ­£å¸¸å·¥ä½œ

### Phase 1.5: UI å¢å¼·ï¼ˆå¯é¸ï¼‰

#### 1.7 è¨ˆæ™‚å™¨ä¸»ç•Œé¢ç‹€æ…‹æŒ‡ç¤º
- [ ] åœ¨è¨ˆæ™‚å™¨ä¸»ç•«é¢æ·»åŠ å°åœ–ç¤ºæŒ‡ç¤ºå±è”½ç‹€æ…‹
  - Focus é‹è¡Œä¸” Shield å•Ÿç”¨ï¼šé¡¯ç¤º ğŸ›¡ï¸ åœ–ç¤º
  - Break é‹è¡Œæˆ– Shield åœç”¨ï¼šä¸é¡¯ç¤ºåœ–ç¤º
- [ ] é»æ“Šåœ–ç¤ºå¯å¿«é€Ÿé€²å…¥ Shield è¨­ç½®

**UI ç¤ºæ„**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      FOCUS TIME           ğŸ›¡ï¸    â”‚ â† å°åœ–ç¤ºè¡¨ç¤ºå±è”½å•Ÿç”¨ä¸­
â”‚                                 â”‚
â”‚         24:58                   â”‚
â”‚                                 â”‚
â”‚     [Pause] [Reset]             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Phase 2: é€²éšåŠŸèƒ½ (v1.3.0)

#### 2.1 è‡ªè¨‚å±è”½ç•«é¢ (iOS 16.0+)
- [ ] å¯¦ç¾ `ShieldConfigurationProvider`
- [ ] è¨­è¨ˆè‡ªè¨‚å±è”½ç•«é¢
- [ ] é¡¯ç¤ºå‰©é¤˜å°ˆæ³¨æ™‚é–“
- [ ] é¡¯ç¤ºæ¿€å‹µæ–‡å­—

#### 2.2 æ™ºèƒ½å»ºè­°
- [ ] åˆ†æç”¨æˆ¶ä½¿ç”¨ç¿’æ…£
- [ ] å»ºè­°å¸¸ç”¨çš„åˆ†æ•£æ³¨æ„åŠ› app
- [ ] å¿«é€Ÿè¨­ç½®æ¨¡æ¿ï¼ˆç¤¾äº¤åª’é«”ã€éŠæˆ²ã€å¨›æ¨‚ç­‰ï¼‰

#### 2.3 çµ±è¨ˆæ•¸æ“š
- [ ] è¨˜éŒ„å±è”½æ¬¡æ•¸ï¼ˆç”¨æˆ¶å˜—è©¦æ‰“é–‹è¢«å±è”½ app çš„æ¬¡æ•¸ï¼‰
- [ ] é¡¯ç¤ºã€Œç¯€çœçš„æ™‚é–“ã€
- [ ] æ•´åˆåˆ°ç¾æœ‰çµ±è¨ˆé é¢

---

## ä»£ç¢¼çµæ§‹

```
TomatoClock/
â”œâ”€â”€ Core/
â”‚   â”œâ”€â”€ Services/
â”‚   â”‚   â”œâ”€â”€ FocusShieldService.swift          // æ ¸å¿ƒå±è”½é‚è¼¯
â”‚   â”‚   â””â”€â”€ FocusShieldAuthManager.swift      // æˆæ¬Šç®¡ç†
â”‚   â””â”€â”€ Models/
â”‚       â””â”€â”€ FocusShieldSettings.swift         // è¨­ç½®æ•¸æ“šæ¨¡å‹
â”œâ”€â”€ Features/
â”‚   â””â”€â”€ FocusShield/
â”‚       â”œâ”€â”€ Views/
â”‚       â”‚   â”œâ”€â”€ FocusShieldSettingsView.swift // è¨­ç½®é é¢
â”‚       â”‚   â”œâ”€â”€ AppSelectionView.swift        // App é¸æ“‡å™¨å°è£
â”‚       â”‚   â””â”€â”€ AuthorizationPromptView.swift // æˆæ¬Šèªªæ˜
â”‚       â””â”€â”€ ViewModels/
â”‚           â””â”€â”€ FocusShieldViewModel.swift    // ViewModel
â””â”€â”€ Extensions/
    â””â”€â”€ FocusShield/
        â””â”€â”€ ShieldConfigurationExtension.appex // Shield é…ç½®æ“´å±• (iOS 16+)
```

---

## æŠ€è¡“ç´°ç¯€

### 1. æ•¸æ“šæŒä¹…åŒ–

ç”±æ–¼ `FamilyActivitySelection` çš„ tokens ç„¡æ³•ç›´æ¥åºåˆ—åŒ–ï¼Œéœ€è¦ç‰¹æ®Šè™•ç†ï¼š

```swift
// å„²å­˜
let defaults = UserDefaults.standard
let encoder = JSONEncoder()
if let encoded = try? encoder.encode(selection.applicationTokens) {
    defaults.set(encoded, forKey: "shieldedApps")
}

// è®€å–
let decoder = JSONDecoder()
if let data = defaults.data(forKey: "shieldedApps"),
   let tokens = try? decoder.decode(Set<ApplicationToken>.self, from: data) {
    store.shield.applications = tokens
}
```

### 2. èˆ‡è¨ˆæ™‚å™¨é›†æˆï¼ˆé›¶ä¾µå…¥å¼ï¼‰

**é—œéµåŸå‰‡ï¼šåªæ·»åŠ ä»£ç¢¼ï¼Œä¸ä¿®æ”¹ç¾æœ‰é‚è¼¯**

åœ¨ `TimerEngine.swift` ä¸­çš„ç¾æœ‰æ–¹æ³•**æœ«å°¾**æ·»åŠ  Focus Shield èª¿ç”¨ï¼š

```swift
func start() throws {
    // === ç¾æœ‰ä»£ç¢¼é–‹å§‹ï¼ˆå®Œå…¨ä¸ä¿®æ”¹ï¼‰===
    guard currentData.state.canStart else {
        throw TimerError.invalidStateTransition(...)
    }

    // ... æ‰€æœ‰ç¾æœ‰çš„è¨ˆæ™‚å™¨å•Ÿå‹•é‚è¼¯ ...

    stateSubject.send(.running)

    if #available(iOS 16.1, *) {
        startLiveActivity()
    }

    saveState()
    // === ç¾æœ‰ä»£ç¢¼çµæŸ ===

    // âœ… æ–°å¢ï¼šFocus Shield é‚è¼¯ï¼ˆåœ¨æœ€å¾Œæ·»åŠ ï¼‰
    // åªåœ¨ Focus æ¨¡å¼æ™‚å•Ÿç”¨å±è”½ï¼ŒBreak å’Œ Long Break ä¸å•Ÿç”¨
    if #available(iOS 15.0, *), currentData.mode == .focus {
        FocusShieldService.shared.enableShield()
    }
}

func pause() throws {
    // === ç¾æœ‰ä»£ç¢¼ï¼ˆå®Œå…¨ä¸ä¿®æ”¹ï¼‰===
    // ... æ‰€æœ‰ç¾æœ‰é‚è¼¯ ...
    // === ç¾æœ‰ä»£ç¢¼çµæŸ ===

    // âœ… æ–°å¢ï¼šæš«åœæ™‚è§£é™¤å±è”½ï¼ˆç„¡è«–æ˜¯ Focus é‚„æ˜¯ Breakï¼‰
    if #available(iOS 15.0, *) {
        FocusShieldService.shared.disableShield()
    }
}

func resume() throws {
    // === ç¾æœ‰ä»£ç¢¼ï¼ˆå®Œå…¨ä¸ä¿®æ”¹ï¼‰===
    // ... æ‰€æœ‰ç¾æœ‰é‚è¼¯ ...
    // === ç¾æœ‰ä»£ç¢¼çµæŸ ===

    // âœ… æ–°å¢ï¼šResume æ™‚æ ¹æ“šæ¨¡å¼æ±ºå®šæ˜¯å¦å•Ÿç”¨å±è”½
    // Resume Focus â†’ é‡æ–°å•Ÿç”¨
    // Resume Break/Long Break â†’ ä¿æŒä¸å±è”½
    if #available(iOS 15.0, *), currentData.mode == .focus {
        FocusShieldService.shared.enableShield()
    }
}

func handleCompletion() {
    // === ç¾æœ‰ä»£ç¢¼ï¼ˆå®Œå…¨ä¸ä¿®æ”¹ï¼‰===
    // ... æ‰€æœ‰ç¾æœ‰é‚è¼¯ ...
    // === ç¾æœ‰ä»£ç¢¼çµæŸ ===

    // âœ… æ–°å¢ï¼šå®Œæˆæ™‚è§£é™¤å±è”½ï¼ˆFocus æˆ– Break å®Œæˆéƒ½è§£é™¤ï¼‰
    // ç†ç”±ï¼šä¸‹ä¸€éšæ®µç”± start() æ±ºå®šæ˜¯å¦å•Ÿç”¨
    if #available(iOS 15.0, *) {
        FocusShieldService.shared.disableShield()
    }
}

func reset() {
    // === ç¾æœ‰ä»£ç¢¼ï¼ˆå®Œå…¨ä¸ä¿®æ”¹ï¼‰===
    // ... æ‰€æœ‰ç¾æœ‰é‚è¼¯ ...
    // === ç¾æœ‰ä»£ç¢¼çµæŸ ===

    // âœ… æ–°å¢ï¼šé‡ç½®æ™‚è§£é™¤å±è”½
    if #available(iOS 15.0, *) {
        FocusShieldService.shared.disableShield()
    }
}
```

**é‡è¦èªªæ˜**:
- âœ… æ‰€æœ‰ Shield èª¿ç”¨éƒ½åŒ…è£¹åœ¨ `@available` æª¢æŸ¥ä¸­ï¼Œç¢ºä¿å‘ä¸‹å…¼å®¹
- âœ… å¦‚æœ Focus Shield æœªå•Ÿç”¨ï¼Œ`enableShield()` å’Œ `disableShield()` å…§éƒ¨æœƒç«‹å³è¿”å›ï¼Œä¸åŸ·è¡Œä»»ä½•æ“ä½œ
- âœ… é€™äº›èª¿ç”¨æ˜¯**é™„åŠ çš„**ï¼Œä¸æœƒå½±éŸ¿ç¾æœ‰çš„è¿”å›å€¼ã€æ‹‹å‡ºéŒ¯èª¤ã€ç‹€æ…‹è®ŠåŒ–ç­‰
- âœ… å³ä½¿ Shield æœå‹™å´©æ½°ï¼Œä¹Ÿä¸æœƒå½±éŸ¿è¨ˆæ™‚å™¨æœ¬èº«ï¼ˆä½¿ç”¨ try? æˆ–å…§éƒ¨éŒ¯èª¤è™•ç†ï¼‰

### 3. FocusShieldService å¯¦ç¾ï¼ˆå®‰å…¨é˜²è­·ï¼‰

```swift
import Combine
import FamilyControls
import ManagedSettings

@available(iOS 15.0, *)
class FocusShieldService: ObservableObject {
    static let shared = FocusShieldService()

    @Published var isEnabled: Bool = false  // ç”¨æˆ¶æ˜¯å¦å•Ÿç”¨æ­¤åŠŸèƒ½
    @Published var authorizationStatus: AuthorizationStatus = .notDetermined

    private let store = ManagedSettingsStore()
    private var cancellables = Set<AnyCancellable>()
    private var selectedApps: Set<ApplicationToken> = []

    private init() {
        // å¾ UserDefaults è®€å–å•Ÿç”¨ç‹€æ…‹
        isEnabled = UserDefaults.standard.bool(forKey: "focusShieldEnabled")

        // ç›£è½æˆæ¬Šç‹€æ…‹
        AuthorizationCenter.shared.$authorizationStatus
            .sink { [weak self] status in
                self?.authorizationStatus = status
            }
            .store(in: &cancellables)

        // è®€å–å·²ä¿å­˜çš„ app æ¸…å–®
        loadSelectedApps()
    }

    /// å•Ÿç”¨å±è”½ - åœ¨ Focus é–‹å§‹æ™‚èª¿ç”¨
    func enableShield() {
        // âš ï¸ é—œéµï¼šå¦‚æœåŠŸèƒ½æœªå•Ÿç”¨æˆ–æ²’æœ‰é¸æ“‡ appï¼Œç«‹å³è¿”å›
        guard isEnabled, !selectedApps.isEmpty else {
            return
        }

        // âš ï¸ éŒ¯èª¤è™•ç†ï¼šå³ä½¿å¤±æ•—ä¹Ÿä¸å½±éŸ¿ä¸»ç¨‹åº
        do {
            store.shield.applications = selectedApps
            print("âœ… [Focus Shield] Enabled for \(selectedApps.count) apps")
        } catch {
            print("âŒ [Focus Shield] Failed to enable: \(error)")
            // ä¸æ‹‹å‡ºéŒ¯èª¤ï¼Œä¸å½±éŸ¿è¨ˆæ™‚å™¨
        }
    }

    /// è§£é™¤å±è”½ - åœ¨ Break/Pause/Reset æ™‚èª¿ç”¨
    func disableShield() {
        // âš ï¸ é—œéµï¼šç¸½æ˜¯å˜—è©¦è§£é™¤ï¼Œç¢ºä¿ç‹€æ…‹ä¸€è‡´
        do {
            store.shield.applications = nil
            print("âœ… [Focus Shield] Disabled")
        } catch {
            print("âŒ [Focus Shield] Failed to disable: \(error)")
            // ä¸æ‹‹å‡ºéŒ¯èª¤ï¼Œä¸å½±éŸ¿è¨ˆæ™‚å™¨
        }
    }

    // ... å…¶ä»–æ–¹æ³•ï¼ˆæˆæ¬Šè«‹æ±‚ã€app é¸æ“‡ç­‰ï¼‰...
}
```

**å®‰å…¨ä¿éšœ**:
1. âœ… ä½¿ç”¨ `guard` ç¢ºä¿åŠŸèƒ½æœªå•Ÿç”¨æ™‚ç«‹å³è¿”å›
2. âœ… æ‰€æœ‰éŒ¯èª¤éƒ½è¢«æ•ç²ï¼Œä¸æœƒå½±éŸ¿èª¿ç”¨è€…
3. âœ… `disableShield()` ç¸½æ˜¯åŸ·è¡Œï¼Œç¢ºä¿åœ¨ä»»ä½•æƒ…æ³ä¸‹éƒ½èƒ½è§£é™¤å±è”½
4. âœ… ä½¿ç”¨å–®ä¾‹æ¨¡å¼ï¼Œç¢ºä¿ç‹€æ…‹ä¸€è‡´æ€§

### 4. å±è”½é…ç½®ï¼ˆiOS 16+ï¼‰

éœ€è¦å‰µå»º App Extension:

```swift
import ManagedSettings
import ManagedSettingsUI

class ShieldConfigurationExtension: ShieldConfigurationDataSource {
    override func configuration(
        shielding application: Application
    ) -> ShieldConfiguration {
        ShieldConfiguration(
            backgroundBlurStyle: .systemThickMaterial,
            backgroundColor: .init(red: 1.0, green: 0.3, blue: 0.3),
            icon: .init(systemName: "tomato.fill"),
            title: .init(
                text: "Stay Focused!",
                color: .label
            ),
            subtitle: .init(
                text: "You chose to focus. Keep going!",
                color: .secondaryLabel
            ),
            primaryButtonLabel: nil,
            primaryButtonBackgroundColor: nil,
            secondaryButtonLabel: nil
        )
    }
}
```

---

## é™åˆ¶èˆ‡æ³¨æ„äº‹é …

### ç³»çµ±é™åˆ¶

1. **æˆæ¬Šè¦æ±‚**
   - å¿…é ˆç²å¾—ç”¨æˆ¶æ˜ç¢ºæˆæ¬Š
   - æˆæ¬Šä¸€æ—¦æ‹’çµ•ï¼Œéœ€è¦ç”¨æˆ¶æ‰‹å‹•åˆ°è¨­å®šä¸­ä¿®æ”¹
   - ç„¡æ³•éœé»˜æˆæ¬Š

2. **API é™åˆ¶**
   - Family Controls ä¸»è¦è¨­è¨ˆç”¨æ–¼å®¶é•·æ§åˆ¶
   - æŸäº›ç³»çµ± app å¯èƒ½ç„¡æ³•å±è”½ï¼ˆå¦‚è¨­å®šã€é›»è©±ï¼‰
   - å±è”½è¨­ç½®æœƒåœ¨æ‰€æœ‰ç™»å…¥åŒä¸€ Apple ID çš„è¨­å‚™é–“åŒæ­¥

3. **ç‰ˆæœ¬è¦æ±‚**
   - åŸºç¤åŠŸèƒ½ï¼šiOS 15.0+
   - è‡ªè¨‚å±è”½ç•«é¢ï¼šiOS 16.0+
   - éœ€è¦åœ¨å°ˆæ¡ˆè¨­å®šä¸­èª¿æ•´æœ€ä½æ”¯æ´ç‰ˆæœ¬æˆ–ä½¿ç”¨ `@available`

### éš±ç§è€ƒé‡

1. **æ•¸æ“šæ”¶é›†**
   - åªå„²å­˜ç”¨æˆ¶é¸æ“‡çš„ app tokensï¼ˆä¸å« app åç¨±æˆ–å¯¦éš›æ•¸æ“šï¼‰
   - Tokens åªåœ¨æœ¬åœ°å„²å­˜
   - ä¸ä¸Šå‚³åˆ°ä¼ºæœå™¨

2. **é€æ˜åº¦**
   - åœ¨æˆæ¬Šå°è©±æ¡†ä¸­æ¸…æ¥šèªªæ˜ç”¨é€”
   - è¨­ç½®é é¢æä¾›è³‡è¨ŠæŒ‰éˆ•ï¼Œè§£é‡‹åŠŸèƒ½é‹ä½œæ–¹å¼
   - å…è¨±ç”¨æˆ¶éš¨æ™‚åœç”¨åŠŸèƒ½

### ç”¨æˆ¶é«”é©—è€ƒé‡

1. **èª¤æ“ä½œä¿è­·**
   - æä¾›å¿«é€Ÿåœç”¨é¸é …ï¼ˆå¾é€šçŸ¥ä¸­å¿ƒï¼Ÿï¼‰
   - è€ƒæ…®æ·»åŠ ã€Œç·Šæ€¥è§£é™¤ã€åŠŸèƒ½
   - åœ¨ Break æ™‚é–“è‡ªå‹•è§£é™¤å±è”½

2. **æ•™è‚²å¼•å°**
   - é¦–æ¬¡ä½¿ç”¨æ™‚æä¾›æ•™å­¸
   - è§£é‡‹ç‚ºä½•éœ€è¦ Screen Time æ¬Šé™
   - æä¾›æœ€ä½³å¯¦è¸å»ºè­°ï¼ˆå»ºè­°å±è”½å“ªäº› appï¼‰

---

## æ›¿ä»£æ–¹æ¡ˆ

### æ–¹æ¡ˆ A: æé†’è€Œéå¼·åˆ¶å±è”½

**å¯¦ç¾**:
- ç›£è½ app åˆ‡æ›ï¼ˆä½¿ç”¨ `NSWorkspace` æˆ–é¡ä¼¼ API - ä½† iOS ä¸Šä¸å¯ç”¨ï¼‰
- ç•¶ç”¨æˆ¶æ‰“é–‹ç‰¹å®š app æ™‚ç™¼é€é€šçŸ¥æé†’

**é™åˆ¶**:
- iOS ä¸å…è¨± app ç›£è½å…¶ä»– app çš„å•Ÿå‹•
- ç„¡æ³•å¯¦ç¾

### æ–¹æ¡ˆ B: æ•´åˆ Focus Mode

**å¯¦ç¾**:
- å¼•å°ç”¨æˆ¶ä½¿ç”¨ç³»çµ±çš„ Focus Mode
- åœ¨ TomatoClock é–‹å§‹å°ˆæ³¨æ™‚å»ºè­°ç”¨æˆ¶å•Ÿç”¨ Focus Mode

**å„ªé»**:
- ä¸éœ€è¦é¡å¤–æ¬Šé™
- åˆ©ç”¨ç³»çµ±åŸç”ŸåŠŸèƒ½

**ç¼ºé»**:
- éœ€è¦ç”¨æˆ¶æ‰‹å‹•æ“ä½œ
- ç„¡æ³•è‡ªå‹•åŒ–
- æ•´åˆåº¦è¼ƒä½

### æ–¹æ¡ˆ C: åƒ…æ”¯æ´ iOS 16+ï¼Œä½¿ç”¨å®Œæ•´åŠŸèƒ½

**æ±ºç­–**: å¦‚æœç›®æ¨™ç”¨æˆ¶ç¾¤ä¸»è¦ä½¿ç”¨è¼ƒæ–°è¨­å‚™ï¼Œå¯ä»¥è€ƒæ…®åƒ…æ”¯æ´ iOS 16+ï¼Œç²å¾—æ›´å¥½çš„å±è”½ç•«é¢è‡ªè¨‚åŠŸèƒ½ã€‚

---

## UI/UX Mock-ups

### è¨­ç½®é é¢æµç¨‹

```
[Settings ä¸»é ]
       â†“ é»æ“Š Focus Shield
[æˆæ¬Šæª¢æŸ¥]
  â†“ å·²æˆæ¬Š         â†“ æœªæˆæ¬Š
[è¨­ç½®é é¢]      [æˆæ¬Šèªªæ˜é ]
  â†“ é¸æ“‡ Apps      â†“ åŒæ„
[App é¸æ“‡å™¨]    [ç³»çµ±æˆæ¬Šå°è©±æ¡†]
  â†“ å®Œæˆ           â†“ å…è¨±
[è¨­ç½®é é¢]      [è¨­ç½®é é¢]
 (é¡¯ç¤ºå·²é¸ Apps)
```

### å¯¦éš›ä½¿ç”¨æµç¨‹

```
[ç”¨æˆ¶å•Ÿå‹• Focus]
       â†“
[TomatoClock æª¢æŸ¥è¨­ç½®]
       â†“
[å•Ÿç”¨ app å±è”½] â† åªåœ¨ Focus æ¨¡å¼ + Focus Shield å•Ÿç”¨æ™‚
       â†“
[Focus æœŸé–“]
  â”œâ”€ [å˜—è©¦æ‰“é–‹è¢«å±è”½çš„ app]
  â”‚       â†“
  â”‚  [é¡¯ç¤ºå±è”½ç•«é¢]
  â”‚    "Stay Focused!"
  â”‚    "23:45 remaining"
  â”‚       â†“
  â”‚  [ç”¨æˆ¶è¿”å›å·¥ä½œ]
  â”‚
  â””â”€ [å˜—è©¦æ‰“é–‹æœªå±è”½çš„ app]
         â†“
    [æ­£å¸¸æ‰“é–‹]
       â†“
[Focus æ™‚é–“çµæŸ]
       â†“
[è‡ªå‹•åˆ‡æ›åˆ° Break]
       â†“
[TomatoClock è§£é™¤å±è”½] âœ…
       â†“
[Break æœŸé–“ - ç”¨æˆ¶å¯è‡ªç”±ä½¿ç”¨æ‰€æœ‰ app]
  åŒ…æ‹¬ä¹‹å‰è¢«å±è”½çš„ app
       â†“
[Break æ™‚é–“çµæŸ]
       â†“
[è‡ªå‹•åˆ‡æ›åˆ° Focus]
       â†“
[TomatoClock é‡æ–°å•Ÿç”¨å±è”½] ğŸ›¡ï¸
       â†“
[å¾ªç’°ç¹¼çºŒ...]
```

---

## æˆåŠŸæŒ‡æ¨™

### æŠ€è¡“æŒ‡æ¨™
- [ ] æˆæ¬ŠæˆåŠŸç‡ > 70%
- [ ] å±è”½å•Ÿç”¨å»¶é² < 1 ç§’
- [ ] è§£é™¤å±è”½å»¶é² < 1 ç§’
- [ ] é›¶å´©æ½°ç‡

### ç”¨æˆ¶æŒ‡æ¨™
- [ ] åŠŸèƒ½å•Ÿç”¨ç‡ > 30%ï¼ˆåœ¨å˜—è©¦åŠŸèƒ½çš„ç”¨æˆ¶ä¸­ï¼‰
- [ ] æŒçºŒä½¿ç”¨ç‡ > 60%ï¼ˆå•Ÿç”¨å¾Œ 7 å¤©ä»åœ¨ä½¿ç”¨ï¼‰
- [ ] ç”¨æˆ¶å›é¥‹æ­£é¢è©•åƒ¹ > 4.0/5.0

---

## æ™‚ç¨‹è¦åŠƒ

| éšæ®µ | ä»»å‹™ | é è¨ˆæ™‚é–“ |
|------|------|----------|
| ç ”ç©¶ | å­¸ç¿’ Family Controls API | 2-3 å¤© |
| è¨­è¨ˆ | UI/UX è¨­è¨ˆå’Œ Mock-ups | 1-2 å¤© |
| é–‹ç™¼ | Phase 1 åŸºç¤åŠŸèƒ½ | 5-7 å¤© |
| æ¸¬è©¦ | åŠŸèƒ½æ¸¬è©¦å’Œé‚Šç•Œæ¸¬è©¦ | 2-3 å¤© |
| é–‹ç™¼ | Phase 2 é€²éšåŠŸèƒ½ | 3-4 å¤© |
| å„ªåŒ– | æ€§èƒ½å’Œ UX å„ªåŒ– | 1-2 å¤© |
| **ç¸½è¨ˆ** | | **14-21 å¤©** |

---

## åƒè€ƒè³‡æº

### Apple å®˜æ–¹æ–‡æª”
- [Family Controls Framework](https://developer.apple.com/documentation/familycontrols)
- [ManagedSettings Framework](https://developer.apple.com/documentation/managedsettings)
- [DeviceActivity Framework](https://developer.apple.com/documentation/deviceactivity)
- [Screen Time API](https://developer.apple.com/documentation/screentime)

### ç¯„ä¾‹å°ˆæ¡ˆ
- [Apple Sample Code: Screen Time API](https://developer.apple.com/documentation/familycontrols/creating_a_screen_time_api_client)

### WWDC Sessions
- WWDC 2021: Meet the Screen Time API
- WWDC 2022: What's new in Screen Time API

---

## å•é¡Œèˆ‡è¨è«–

### Q1: å¦‚æœç”¨æˆ¶åœ¨ Focus æœŸé–“é—œé–‰ TomatoClock app æœƒæ€æ¨£ï¼Ÿ

**A**: å±è”½è¨­ç½®æœƒæŒçºŒç”Ÿæ•ˆï¼Œå› ç‚ºå®ƒæ˜¯ç”±ç³»çµ±çš„ `ManagedSettings` ç®¡ç†ï¼Œä¸ä¾è³´ app é‹è¡Œç‹€æ…‹ã€‚ä½†éœ€è¦ç¢ºä¿ï¼š

**å¯¦ç¾è¦æ±‚**:
1. åœ¨ app çµ‚æ­¢å‰ä¿å­˜å®Œæ•´ç‹€æ…‹ï¼ˆç¾æœ‰çš„ `saveState()` å·²å¯¦ç¾ï¼‰
2. åœ¨ `AppDelegate` æˆ– `SceneDelegate` çš„ app å•Ÿå‹•æ™‚æ·»åŠ å±è”½ç‹€æ…‹æª¢æŸ¥ï¼š

```swift
// åœ¨ app å•Ÿå‹•æˆ–é€²å…¥å‰æ™¯æ™‚
@available(iOS 15.0, *)
private func syncShieldStateWithTimer() {
    // è®€å–ç•¶å‰è¨ˆæ™‚å™¨ç‹€æ…‹
    guard let timerData = persistence.loadTimerData(),
          !timerData.isStale else {
        // ç‹€æ…‹éæœŸï¼Œè§£é™¤å±è”½
        FocusShieldService.shared.disableShield()
        return
    }

    // æª¢æŸ¥ç•¶å‰æ‡‰è©²åœ¨å“ªå€‹éšæ®µ
    if timerData.state == .running {
        // å¦‚æœæ˜¯ Focus æ¨¡å¼ä¸”åŠŸèƒ½å•Ÿç”¨ï¼Œç¢ºä¿å±è”½ç”Ÿæ•ˆ
        if timerData.mode == .focus {
            FocusShieldService.shared.enableShield()
        } else {
            // å¦‚æœæ˜¯ Break æ¨¡å¼ï¼Œç¢ºä¿å±è”½å·²è§£é™¤
            FocusShieldService.shared.disableShield()
        }
    } else {
        // å…¶ä»–ç‹€æ…‹ï¼ˆpaused, ready, completedï¼‰ï¼Œè§£é™¤å±è”½
        FocusShieldService.shared.disableShield()
    }
}
```

**é—œéµé»**:
- âœ… åˆ©ç”¨ç¾æœ‰çš„ `TimerData` æŒä¹…åŒ–
- âœ… åœ¨ app å•Ÿå‹•æ™‚åŒæ­¥å±è”½ç‹€æ…‹
- âœ… è™•ç†ç‹€æ…‹éæœŸçš„æƒ…æ³ï¼ˆ> 1 å°æ™‚ï¼‰

### Q2: å¦‚æœç”¨æˆ¶å¼·åˆ¶é‡å•Ÿæ‰‹æ©Ÿæœƒæ€æ¨£ï¼Ÿ

**A**: éœ€è¦å¯¦ç¾ï¼š
1. æŒä¹…åŒ–ç•¶å‰æ¨¡å¼ï¼ˆFocus/Breakï¼‰ã€ç‹€æ…‹å’Œé è¨ˆçµæŸæ™‚é–“
2. App å•Ÿå‹•æ™‚æª¢æŸ¥ç•¶å‰æ‡‰è©²åœ¨å“ªå€‹éšæ®µï¼š
   - å¦‚æœæ‡‰è©²åœ¨ Focus æœŸé–“ â†’ é‡æ–°å•Ÿç”¨å±è”½
   - å¦‚æœæ‡‰è©²åœ¨ Break æœŸé–“ â†’ ç¢ºä¿å±è”½å·²è§£é™¤
   - å¦‚æœè¨ˆæ™‚å™¨å·²å®Œå…¨çµæŸ â†’ ç¢ºä¿å±è”½å·²è§£é™¤
3. é‡è¦ï¼šå³ä½¿ç”¨æˆ¶é‡å•Ÿï¼Œä¹Ÿè¦ç¶­æŒæ­£ç¢ºçš„ Focus/Break å¾ªç’°å’Œå±è”½ç‹€æ…‹

### Q3: ç”¨æˆ¶å¯ä»¥ç¹éå±è”½å—ï¼Ÿ

**A**: å¯ä»¥ï¼Œç”¨æˆ¶å¯ä»¥ï¼š
1. åˆ°è¨­å®š > Screen Time ä¸­ä¿®æ”¹
2. åœ¨ TomatoClock ä¸­åœç”¨ Focus Shield
3. å¼·åˆ¶é—œé–‰ TomatoClockï¼ˆå¯èƒ½å°è‡´å±è”½ç‹€æ…‹ä¸ä¸€è‡´ï¼‰

é€™æ˜¯**è‡ªæˆ‘ç®¡ç†å·¥å…·**ï¼Œä¸æ˜¯å¼·åˆ¶æ€§é™åˆ¶ã€‚é‡é»æ˜¯æä¾›å”åŠ©ï¼Œè€Œéå®Œå…¨é˜»æ“‹ã€‚

### Q4: éœ€è¦æäº¤ App Store å¯©æ ¸å—ï¼Ÿ

**A**: éœ€è¦ã€‚ä½¿ç”¨ Family Controls éœ€è¦æä¾›å¯©æ ¸èªªæ˜ï¼š
1. èªªæ˜ç‚ºä½•éœ€è¦é€™å€‹æ¬Šé™
2. å¦‚ä½•ä½¿ç”¨ï¼ˆè¢å¹•æˆªåœ–å’Œèªªæ˜æ–‡å­—ï¼‰
3. ç¢ºä¿ç¬¦åˆ App Store å¯©æ ¸æŒ‡å—
4. æº–å‚™å¥½å›ç­”å¯©æ ¸åœ˜éšŠçš„å•é¡Œ

---

## æ±ºç­–è¨˜éŒ„

| æ—¥æœŸ | æ±ºç­– | ç†ç”± |
|------|------|------|
| 2025-10-22 | æ¡ç”¨ Family Controls API | Apple å®˜æ–¹è§£æ±ºæ–¹æ¡ˆï¼ŒåŠŸèƒ½å®Œæ•´ä¸”å®‰å…¨ |
| 2025-10-22 | **é›¶ä¾µå…¥å¼è¨­è¨ˆ** | å®Œå…¨å¯é¸çš„é™„åŠ åŠŸèƒ½ï¼Œä¸ä¿®æ”¹ç¾æœ‰ä»£ç¢¼é‚è¼¯ |
| 2025-10-22 | é»˜èªé—œé–‰ | ç”¨æˆ¶éœ€ä¸»å‹•å•Ÿç”¨ï¼Œé¿å…æ„å¤–å½±éŸ¿ä½¿ç”¨é«”é©— |
| 2025-10-22 | åªåœ¨ Focus å±è”½ï¼ŒBreak è§£é™¤ | ç¬¦åˆç•ªèŒ„é˜ç†å¿µï¼šå·¥ä½œå°ˆæ³¨ï¼Œä¼‘æ¯æ”¾é¬† |
| 2025-10-22 | Resume æ ¹æ“šæ¨¡å¼æ±ºå®šå±è”½ | Resume Focus é‡æ–°å•Ÿç”¨ï¼ŒResume Break ä¿æŒè§£é™¤ |
| 2025-10-22 | App å•Ÿå‹•æ™‚åŒæ­¥å±è”½ç‹€æ…‹ | ç¢ºä¿ app è¢«çµ‚æ­¢å¾Œé‡å•Ÿæ™‚ç‹€æ…‹ä¸€è‡´ |
| 2025-10-22 | æ·»åŠ ç‹€æ…‹æŒ‡ç¤ºå™¨ | è®“ç”¨æˆ¶æ¸…æ¥šçŸ¥é“ç•¶å‰å±è”½æ˜¯å¦å•Ÿç”¨ |
| TBD | æœ€ä½æ”¯æ´ç‰ˆæœ¬ï¼šiOS 15.0ï¼ˆåŠŸèƒ½ï¼‰<br>iOS 14ï¼ˆapp æœ¬èº«ï¼‰ | æ–°åŠŸèƒ½éœ€è¦ iOS 15+ï¼Œä½† app ä»æ”¯æ´ iOS 14 |
| TBD | è‡ªè¨‚å±è”½ç•«é¢ç‚ºå¯é¸åŠŸèƒ½ | iOS 16+ é™å®šï¼Œå‘ä¸‹å…¼å®¹ |

---

## ä¸‹ä¸€æ­¥

1. **å¯©æ ¸æ­¤æ–‡æª”**ï¼šåœ˜éšŠè¨è«–ä¸¦ç¢ºèªè¨­è¨ˆæ–¹æ¡ˆ
2. **å‰µå»ºæŠ€è¡“åŸå‹**ï¼šé©—è­‰ Family Controls API çš„å¯¦éš›æ•ˆæœ
3. **UI è¨­è¨ˆ**ï¼šå‰µå»ºè©³ç´°çš„ UI mock-ups
4. **é–‹å§‹é–‹ç™¼**ï¼šPhase 1 åŸºç¤åŠŸèƒ½å¯¦ç¾

---

**æ–‡æª”ç‹€æ…‹**: ç­‰å¾…å¯©æ ¸
**è² è²¬äºº**: TBD
**æœ€å¾Œæ›´æ–°**: 2025-10-22
